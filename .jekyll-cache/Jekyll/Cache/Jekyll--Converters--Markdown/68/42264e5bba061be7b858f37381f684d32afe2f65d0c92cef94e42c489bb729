I"”<p><em>An exploration of blind signal separation using convex optimization. Materials are covered in EE 364A Convex Optimization at Stanford University</em></p>

<h2 id="introduction">Introduction</h2>

<p>Signal separations problems deal generally estimating component signals from from some one or more observed combinations of the signals. In blind signal separation (BSS), you have no or little information about the underlying signals. In partiuclar, we suppose that we don‚Äôt have a training dataset of separated signals with which to train a model.</p>

<p>In single-channel signal separation, you measure a signal that is a mixture of other signals, and you estimate what the underlyings signals are. The mathematical model for this problem is</p>

<script type="math/tex; mode=display">x[t] = \sum_{k=1}^K s_k[t],</script>

<p>where $x[t]$ is the measured signal, and there are $K$ component signals, $s_k[t]$. This is generally more difficult than multi-channel signal separation, where you have access to multiple observed channels, each with a different linear mixture of the component signals.</p>

<p>One of the most common applications of this problem is noise filtering or smoothing. In this case, you only have two signals, the thing you are trying to measure and the noise in the measurement. There are many, many solutions to this problem, everything from <a href="https://en.wikipedia.org/wiki/Low-pass_filter">low-pass filters</a> to <a href="https://en.wikipedia.org/wiki/Spline_interpolation">spline fits</a>. However, more interesting cases occur when there are more than one component signal that is not noise. In this case, the problem is highly <a href="https://en.wikipedia.org/wiki/Underdetermined_system">underdetermined</a>, meaning that there are many more unknowns than constraints, so there is no clear single or best solution. However, under a variety of conditions, it is possible to find useful solutions to the problem</p>

<p>In this post, we‚Äôll explore the use of convex optimization to perform single-channel BSS. Convex optimization is a natural fit for convex optimization because of the ease of adding various <a href="https://en.wikipedia.org/wiki/Regularization_(mathematics)">regularization terms</a>, which handle the underdetermined nature of the problem. We use these regularization terms to represent our ‚Äúprior knowledge‚Äù about the compoenent signals. For example, the <a href="https://en.wikipedia.org/wiki/Lasso_%28statistics%29">$\ell_1$-norm regularization</a> can be viewed as representing belief that a signal is sparse (that it has a lot of zeros). Some other examples will be explained more fully below</p>

<p>We start by setting up our Python session and creating some synthetic data to work with.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="n">cvx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="nb">set</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="s">'talk'</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s">'colorblind'</span><span class="p">)</span></code></pre></figure>

<p>In this example. there are two component signals. Neither signal has any periodicity, but they are noticibly different from each other. The first signal fluctuates up and down, but changes relatively smoothly over time. The second signal can only be in one of three states, $-1$, $0$, or $1$, so it is either flat or has a sharp discontinuity. We will first look at the case without any noise, which is relatively easy to solve. Then, we‚Äôll see what happens when we add noise</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">signal1</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">/</span> <span class="p">(</span><span class="mf">500.</span><span class="p">))</span>
           <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">/</span> <span class="p">(</span><span class="mf">550.</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">/</span> <span class="p">(</span><span class="mf">550.</span><span class="p">))))</span>
<span class="n">signal2</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mf">500.</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
           <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">/</span> <span class="p">(</span><span class="mf">500.</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="mi">13</span> <span class="o">/</span> <span class="p">(</span><span class="mf">550.</span><span class="p">)))</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
           <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c1"># center at zero
</span><span class="n">observed</span> <span class="o">=</span> <span class="n">signal1</span> <span class="o">+</span> <span class="n">signal2</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Smooth Signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Tri-State Signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Observed Signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$t$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_4_0.png" alt="png" /></p>

<h2 id="formulating-the-convex-optimization-problem">Formulating the Convex Optimization Problem</h2>

<p>To recap, we‚Äôve collected the observed signal as data, and we‚Äôd like to estimate the two component signals. We assume that we know the following:</p>

<ul>
  <li>The number of component signals ($K=2$)</li>
  <li>That one of the signals should be smooth</li>
  <li>That one of the signals is tri-state (-1, 0, 1)</li>
</ul>

<p>Our model is</p>

<script type="math/tex; mode=display">x[t] = s_1[t] + s_2[t],</script>

<p>and we seek to solve the optimization problem</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{alignat*}{2}
& \underset{\hat{x}, \hat{s}_1, \hat{s}_2}{\text{minimize}}
& & \quad \left\lVert x - \hat{x}\right\rVert_2 \\
& \text{subject to}
& & \quad \hat{x} = \hat{s}_1 + \hat{s}_2.
\end{alignat*} %]]></script>

<p>In the above equation, $x\in\mathbf{R}^n$ is the problem data (observed signal), and $\hat{x}$, $\hat{s}_1$, and $\hat{s}_2$ are the problem variables. Of course, without any other constraints, a trivial solution to this is $s_1=x$ and $s_2=\mathbf{0}$. This is where the regularization functions come in. We reformulate the problem as follows</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{alignat*}{2}
& \underset{\hat{x}, \hat{s}_1, \hat{s}_2}{\text{minimize (w.r.t. $\mathbf{R}_{+}^3$)}}
& & \quad \left(\left\lVert x - \hat{x}\right\rVert_2, \phi_1(\hat{s}_1),\phi_2(\hat{s}_1) \right)\\
& \text{subject to}
& & \quad \hat{x} = \hat{s}_1 + \hat{s}_2.
\end{alignat*} %]]></script>

<p>Assuming that the <em>regularization functions</em>, $\phi_i$, are convex, this is a convex, multi-criterion problem. There exist many <a href="https://en.wikipedia.org/wiki/Pareto_efficiency">Pareto optimal</a> solutions, i.e. points where it is impossible to reduce any criterion without making the other criteria larger. Many of these solutions, unfortunately, do not do a good job of separating the signals, but others do. We‚Äôll have to use some heuristics to figure out which solutions are useful.</p>

<p>Now, we need to design our regularization functions. As mentioned before, we want one of the signals to be smooth. A good way to do this is by putting a penalty on the <a href="https://en.wikipedia.org/wiki/Finite_difference#Higher-order_differences">$2^{\text{nd}}$-order finite difference</a> of $s_1$. The $2^{\text{nd}}$-order finite difference is a linear transform defined by the matrix $\mathcal{D}_{2}\in\mathbf{R}^{(n-2)\times n}$, which takes a signal, $s[t]\in\mathbf{R}^n$, and returns the signal</p>

<script type="math/tex; mode=display">s''[t] = \mathcal{D}_2 s[t] = s[t] - 2\cdot s[t+1] + s[t+2]\in\mathbf{R}^{n-2}.</script>

<p>It provides a discrete estimate of the $2^{\text{nd}}$ derivative of the original signal. In other words, this penalty selects for a signal that does not have rapid in changes in slope, a reasonable definition for something smooth. So, we define</p>

<script type="math/tex; mode=display">\phi_1(s)=\left\lVert \mathcal{D}_2 s \right\rVert_2.</script>

<p>This is a convex function in $s$, so our problem is still convex. We want the second signal to be tri-state, but 
limiting the entries of $\hat{s}_2$ to be in the set <script type="math/tex">\{-1,0,1\}</script> is non-convex constraint, so cannot directly encode this information. Instead, we can restrict $\hat{s}_2$ to the <a href="https://en.wikipedia.org/wiki/Convex_hull">convex hull</a> of its feasible set</p>

<script type="math/tex; mode=display">-1 \preceq \hat{s}_2 \preceq 1</script>

<p>and penalize the <em>total variation</em> of the signal, defined as</p>

<script type="math/tex; mode=display">\phi_{\text{tv}}(s) = \sum_{i=1}^{n-1}\left\lvert s[t+1] - s[t] \right\rvert = \left\lVert \mathcal{D}_1 s\right\rVert_1.</script>

<p>This penalty selects for a signal that has a sparse $1^{\text{st}}$-order difference. Unlike the previous smoothing function, this function allows for a small number large ‚Äújumps‚Äù while keeping the rest of the signal ‚Äúflat‚Äù, which is a good heuristic for the tri-state behavior we are looking for. For now, we simply set $\phi_2=\phi_{\text{tv}}$. Later, when we introduce some noise, we‚Äôll see that we can make a small alteration to $\phi_2$ that gives much improved performance.</p>

<p>Finally, we scalarize the multi-criterion by forming the weighted sum of the objective functions, allowing us to parameterize the optimal tradeoff frontier. This gives us the canonical convex minimization problem</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{alignat*}{2}
& \underset{\hat{x}, \hat{s}_1, \hat{s}_2}{\text{minimize}}
& & \quad \left\lVert x - \hat{x}\right\rVert_2 + \mu_1 \left\lVert \mathcal{D}_2 \hat{s}_1 \right\rVert_2 + \mu_2 \left\lVert \mathcal{D}_1 \hat{s}_2\right\rVert_1 \\
& \text{subject to}
& & \quad \hat{x} = \hat{s}_1 + \hat{s}_2,\quad -1 \preceq \hat{s}_2 \preceq 1.
\end{alignat*} %]]></script>

<p>As a reference point, let‚Äôs now evaluate the value of our two regularization functions on the original component signals.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">ph1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">signal1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="n">ph2</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">signal2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="k">print</span> <span class="s">'phi_1 actual:  {:.2f}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ph1</span><span class="p">)</span>
<span class="k">print</span> <span class="s">'phi_2 actual: {:.1f}'</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ph2</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">phi_1</span> <span class="n">actual</span><span class="p">:</span>  <span class="mf">0.13</span>
    <span class="n">phi_2</span> <span class="n">actual</span><span class="p">:</span> <span class="mf">48.0</span></code></pre></figure>

<h3 id="selecting-hyperparameters">Selecting Hyperparameters</h3>

<p>While we won‚Äôt know this information in a ‚Äúreal‚Äù problem instance, it‚Äôs good to have some sense of what values are reaasonable for these functions, when we look at how to select useful points for the set of parateo-optimal solutions. Next, we‚Äôll use <code class="highlighter-rouge">cvxpy</code> to explore the Pareto optimal frontier and look for a particular solution that gives a useful separation of the signal.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s2_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">mu3</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed</span> <span class="o">-</span> <span class="p">(</span><span class="n">s1_hat</span> <span class="o">+</span> <span class="n">s2_hat</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s1_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">mu2</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">f4</span> <span class="o">=</span> <span class="n">mu3</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span> <span class="o">+</span> <span class="n">f4</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">cvx</span><span class="o">.</span><span class="n">sum_entries</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">]</span>
<span class="n">output1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">):</span>
        <span class="n">mu1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">m1</span>
        <span class="n">mu2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">m2</span>
        <span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
        <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span>
        <span class="n">output1</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">f2</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f3</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">])</span>
<span class="n">output1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="mi">30</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">im0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output1</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$|| x - s_1 - s_2 ||_2$'</span><span class="p">)</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output1</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">phi_1$'</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output1</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">phi_2$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">box1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">'orange'</span><span class="p">)</span>
<span class="n">box2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">'orange'</span><span class="p">)</span>
<span class="n">box3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="mi">25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s">'orange'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">box1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">box2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">box3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_9_0.png" alt="png" /></p>

<p>The orange rectangles above show a stable region in the Pareto optimal frontier, which corresponds to objective functions values close to what we measured on the true component signals. Let‚Äôs evaluate that range of $\mu_1$ and $\mu_2$ more closely.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">output2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m1</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">m2</span> <span class="ow">in</span>  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.05</span><span class="p">,</span><span class="mf">.15</span><span class="p">,</span><span class="mi">21</span><span class="p">):</span>
        <span class="n">mu1</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">m1</span>
        <span class="n">mu2</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">m2</span>
        <span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
        <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span>
        <span class="n">output2</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">f2</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f3</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu2</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">])</span>
<span class="n">output2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">output2</span><span class="p">)</span><span class="o">.</span><span class="n">T</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">im0</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$|| x - s_1 - s_2 ||_2$'</span><span class="p">)</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">phi_1$'</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tripcolor</span><span class="p">(</span><span class="n">output2</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">output2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_1$'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">mu_2$'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'$</span><span class="se">\\</span><span class="s">phi_2$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">15</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s">'orange'</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">.15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_12_0.png" alt="png" /></p>

<h3 id="signal-separation">Signal Separation</h3>

<p>In the second set of plots above, we‚Äôve shown the point corresponding to $\mu_1=15$ and $\mu_2=0.1$, which we can see is close to the center of this stable region. We‚Äôll use these values, and see how well we can separate the signal.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">x_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s1_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s2_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed</span> <span class="o">-</span> <span class="n">x_hat</span><span class="p">)</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s1_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">mu2</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">x_hat</span> <span class="o">==</span> <span class="n">s1_hat</span> <span class="o">+</span> <span class="n">s2_hat</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">]</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s">'Problem value: {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s">'f1 value:       {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s3</span> <span class="o">=</span> <span class="s">'phi1 value:     {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s4</span> <span class="o">=</span> <span class="s">'phi2 value:    {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span> <span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="n">s3</span><span class="o">+</span><span class="n">s4</span><span class="p">)</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f3</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">Problem</span> <span class="n">value</span><span class="p">:</span> <span class="mf">6.71</span>
    <span class="n">f1</span> <span class="n">value</span><span class="p">:</span>       <span class="mf">0.01</span>
    <span class="n">phi1</span> <span class="n">value</span><span class="p">:</span>     <span class="mf">0.13</span>
    <span class="n">phi2</span> <span class="n">value</span><span class="p">:</span>    <span class="mf">47.84</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s1_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Optimally seperated component signals, compared to the oracle'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_15_0.png" alt="png" /></p>

<p>Not bad! That‚Äôs almost a perfect reconstruction of the component signals. Looking closely at the residuals, we see that $\hat{s}_2$ is not exactly the tri-state signal we are looking for:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal2</span> <span class="o">-</span> <span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Residual $s_2 - </span><span class="se">\\</span><span class="s">hat{s}_2$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_17_0.png" alt="png" /></p>

<p>That said, we could easily project this onto the set <script type="math/tex">\left\{-1,0,1\right\}</script> and get a perfect reconstruction of the original signals.</p>

<h2 id="adding-noise">Adding Noise</h2>

<p>Now let‚Äôs make things a little more interesting and add some measurement noise. We‚Äôll use Gaussian, white noise with a mean of zero and a standard deviation of $0.1$, or $10\%$ of the step size in the tri-state signal.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
<span class="n">observed</span> <span class="o">=</span> <span class="n">signal1</span> <span class="o">+</span> <span class="n">signal2</span> <span class="o">+</span> <span class="n">noise</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Smooth Signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Tri-State Signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Observed Signal with noise'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'$t$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_20_0.png" alt="png" /></p>

<p>Okay, we have our noise observation of the mixed signal. Let‚Äôs see how the approach we developed above fares on this noisy version of the problem.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">x_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s1_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s2_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed</span> <span class="o">-</span> <span class="n">x_hat</span><span class="p">)</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s1_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">mu2</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">x_hat</span> <span class="o">==</span> <span class="n">s1_hat</span> <span class="o">+</span> <span class="n">s2_hat</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">]</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s">'Problem value: {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s">'f1 value:       {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s3</span> <span class="o">=</span> <span class="s">'phi1 value:     {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s4</span> <span class="o">=</span> <span class="s">'phi2 value:    {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span> <span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="n">s3</span><span class="o">+</span><span class="n">s4</span><span class="p">)</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f3</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">Problem</span> <span class="n">value</span><span class="p">:</span> <span class="mf">11.12</span>
    <span class="n">f1</span> <span class="n">value</span><span class="p">:</span>       <span class="mf">5.85</span>
    <span class="n">phi1</span> <span class="n">value</span><span class="p">:</span>     <span class="mf">0.13</span>
    <span class="n">phi2</span> <span class="n">value</span><span class="p">:</span>    <span class="mf">33.24</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s1_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Optimally seperated component signals, compared to the oracle'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_23_0.png" alt="png" /></p>

<h3 id="improving-the-estimates-under-noisy-conditions">Improving the estimates under noisy conditions</h3>

<p>Now things are a bit more interesting. Unlike in the noise-free case, we now see some significant errors in the estimation of the comoponent signals. Of particular interest, we see that our estimation of the tri-state signal, while capturing the step-changes in the original signal, does a poor job of achieving the zero-values. Applying an $\ell_1$-norm penalty to this vector, sometimes known <a href="https://en.wikipedia.org/wiki/Lasso_%28statistics%29">lasso regularization</a>, encourages the vector to be sparse, meaning it has many zero entries. So, we alter the second regularization function with a ‚Äúlittle bit‚Äù of lasso regularization like so:</p>

<script type="math/tex; mode=display">\phi_2(s) = \phi_{\text{tv}}(s) + 10^{-3}\cdot \left\lVert s \right\rVert_1.</script>

<p>As we‚Äôll now see, this helps to ‚Äúcenter‚Äù the estimate of the tri-state signal.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s2_hat</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">mu1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">mu2</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">mu3</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed</span> <span class="o">-</span> <span class="p">(</span><span class="n">s1_hat</span> <span class="o">+</span> <span class="n">s2_hat</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s1_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">f3</span> <span class="o">=</span> <span class="n">mu2</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">f4</span> <span class="o">=</span> <span class="n">mu3</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">s2_hat</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span> <span class="o">+</span> <span class="n">f4</span><span class="p">)</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">s2_hat</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">s2_hat</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">]</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="s">'Problem value: {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s2</span> <span class="o">=</span> <span class="s">'f1 value:       {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s3</span> <span class="o">=</span> <span class="s">'phi1 value:     {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="n">s4</span> <span class="o">=</span> <span class="s">'phi2 value:    {:.2f}</span><span class="se">\n</span><span class="s">'</span>
<span class="k">print</span> <span class="p">(</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="o">+</span><span class="n">s3</span><span class="o">+</span><span class="n">s4</span><span class="p">)</span><span class="o">.</span><span class="nb">format</span><span class="p">(</span><span class="n">problem</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f2</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu1</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">f3</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">mu2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">Problem</span> <span class="n">value</span><span class="p">:</span> <span class="mf">11.23</span>
    <span class="n">f1</span> <span class="n">value</span><span class="p">:</span>       <span class="mf">5.90</span>
    <span class="n">phi1</span> <span class="n">value</span><span class="p">:</span>     <span class="mf">0.13</span>
    <span class="n">phi2</span> <span class="n">value</span><span class="p">:</span>    <span class="mf">32.59</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s2_proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">s2_proj</span><span class="p">[</span><span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s2_proj</span><span class="p">[</span><span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s1_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="c1">#ax[1].plot(t, s2_proj, linewidth=1, alpha=.5, label='projected')
</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_26_0.png" alt="png" /></p>

<p>Much better. As mentioned earlier, we can now project the solution for $\hat{s}_2$ onto the feasible set <script type="math/tex">\{-1,0,1\}</script>. We‚Äôll use the following projection:</p>

<script type="math/tex; mode=display">% <![CDATA[
\pi(\hat{s}_2[t]) = \begin{cases}
1 & \text{if } \hat{s}_2[t] > \frac{1}{4} \\
0 & \text{if } -\frac{1}{4} \leq \hat{s}_2[t] \leq \frac{1}{4} \\
-1 & \text{if } \hat{s}_2[t] < -\frac{1}{4}
\end{cases} %]]></script>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s2_proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">s2_proj</span><span class="p">[</span><span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s2_proj</span><span class="p">[</span><span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'optimal solution'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_proj</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'projected'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'actual signal'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'red'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'projection limits'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'red'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_28_0.png" alt="png" /></p>

<p>If we now freeze our estimate of $s_2$ as this projected signal, we can resolve for $\hat{s}_1$ and get a better estimate of the smooth signal.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">mu1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">sign</span><span class="o">=</span><span class="s">'positive'</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">f1</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed</span> <span class="o">-</span> <span class="p">(</span><span class="n">s1_hat</span> <span class="o">+</span> <span class="n">s2_proj</span><span class="p">))</span>
<span class="n">f2</span> <span class="o">=</span> <span class="n">mu1</span> <span class="o">*</span> <span class="n">cvx</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">cvx</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">s1_hat</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">objective</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span><span class="p">)</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">cvx</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
<span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s">'MOSEK'</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s1_hat</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">A1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'reconstructed smoooth signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'original smoooth signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s2_proj</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'reconstructed tri-state signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">'original tri-state signal'</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span><span class="mf">.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></figure>

<p><img src="http://localhost:4000/assets/output_31_0.png" alt="png" /></p>

<p>That‚Äôs pretty good! In this problem instance, we miss one segment of the tri-state signal, causing us to also mis-estimate the smooth signal during that period. But still, not bad. One could potentially spend more time designing an optimal projection function that may solve this problem, but overall this method does quite well.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In this post we‚Äôve explored using convex optimization to perform single-channel blind signal separation. We found that in the absense of noise, we can easily separate our example signals based on simple regularization functions, which capture our prior knowledge of the signals‚Äô behaviors‚Äîsmoothness and sparse first-order differences.</p>

<p>Adding noise to the problem makes it significantly harder, and it is no longer a trivial task to separate the signals. However, with the addition of two more heuristics‚Äîlasso regularization and projection onto the feasible set‚Äîwe are able to get a very good estimate of the original signals.</p>
:ET